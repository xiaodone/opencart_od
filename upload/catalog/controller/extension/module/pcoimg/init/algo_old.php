<?php $eo_images_object=array(); if(!empty($query->row) && !empty($query->row['product_option_value_id'])){echo "window.pcbi.first_image='".$query->row['product_option_value_id']."';"; } if($query->num_rows){foreach($query->rows as $row){$img=$this->eo_gen_img($row['image']); if($zoom_plus_status){$this->eo_zoomplus_factory($row['image']); } if(!empty($row['product_option_value_id'])){$eo_images_object[$row['product_option_value_id']][]= $this->eo_prepare_img($img['image'],$img['product'],$img['thumb'],$img['popup'],$row['image']); } } } echo "window.pcbi.image_map=JSON.parse('".json_encode($eo_images_object)."');"; $query = $this->db->query("SELECT image FROM `" . DB_PREFIX . "product` WHERE product_id=".$product_id); $img=$this->eo_gen_img($query->rows[0]['image']); if($zoom_plus_status){$this->eo_zoomplus_factory($query->rows[0]['image']); } echo "window.pcbi.main_image=JSON.parse('". json_encode($this->eo_prepare_img($img['image'],$img['product'],$img['thumb'],$img['popup'],$query->rows[0]['image'])) . "');"; echo "window.pcbi.algo_type='".($zoom_plus_status?'zoom_plus':'default')."';"; echo "window.pcbi.main_img_ops='".@$this->config->get('module_productcolorbasedimages_main_img_config')."';"; $result=$this->db->query( "SELECT * FROM `" . DB_PREFIX . "hsquare_config` where hc_key = 'THUMB_IMAGE_QUERY' AND hc_module_code='pcbi'"); if($result->num_rows>0){echo "window.pcbi.thumb_image_query='".html_entity_decode($result->row['hc_value'])."';"; } else {echo "window.pcbi.thumb_image_query='';"; } $result=$this->db->query( "SELECT * FROM `" . DB_PREFIX . "hsquare_config` where hc_key = 'ICON_IMAGE_QUERY' AND hc_module_code='pcbi'"); if($result->num_rows>0){echo "window.pcbi.icon_image_query='".html_entity_decode($result->row['hc_value'])."';"; } else {echo "window.pcbi.icon_image_query='';"; } echo "if(window.pcbi.main_img_ops==''){ window.pcbi.main_img_ops='0'; } window.eo_crc32=function(r){for(var a,o=[],c=0;c<256;c++){a=c;for(var f=0;f<8;f++)a=1&a?3988292384^a>>>1:a>>>1;o[c]=a}for(var n=-1,t=0;t<r.length;t++)n=n>>>8^o[255&(n^r.charCodeAt(t))];return(-1^n)>>>0}; if(window.pcbi.first_image==''){ if(typeof(window.pcbi.image_map)=='object' && (Object.keys(window.pcbi.image_map)).length>=1){window.pcbi.first_image=Object.keys(window.pcbi.image_map)[0]; } } </script>"; require_once('catalog/controller/extension/module/productcolorbasedimages/alert/error_404.php');